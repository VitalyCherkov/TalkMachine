# **TalkMachine**

## Содержание

* Ошибки и сообщения
    * Атомарное сообщение
    * Классификация кодов сообщений
    * Ошибки форм

* API

## Ошибки и сообщения

### Атомарное сообщение
Все сообщения и ошибки ошибки в конечном счете состоят из комбинации (или только из самой одной) атомарных ошибок. Атомарная ошибка характеризуется двумя параметрами: **кодом** и **текстом**.

```javascript
// atomic message object (AEO)
{
    'c': 1234, // 'c' - Code - код сообщения. Всего одна буква, т.к. таких сообщений очень много, поэтому есть смысл сэкономить объем
    't': 'Error text' // 't' - Text - текст сообщения.
    'v': 'tolstoy@lev.ru' // 'v' - Value (значение). Опционально, если, например, это поле заполнено корректно и нам нужно сохранить его значение
}
```

### Классификация кодов сообщений

// TODO:

Здесь пока ничего нет, но идея такова: сообщения AJAX будут в одном диапазоне значений, а сообщения Websocket в другом диапазоне.

Также в кажом диапазоне есть поддиапазоны для информационных сообщений, сообщений об ошибке и (возможно) сообщений об успешном заверешнии

Пример:

```
[-------------- AJAX -------------][----------- Websocket -----------]
 [-- suc --][-- log --][-- err --]  [-- suc --][-- log --][-- err --]
```

Код до 2х байт:

Маска
```
[ , ] [ , ] [ , , , ] [ , , , , , , , ]
 код   рез.   тема         подтема
```
* Код
    * 00 - AJAX
    * 01 - WS
* Рез. (результат) _использование всех кодов, конечно, под вопросом) но пусть лучше будет_
    * 00 - Success
    * 01 - Info
    * 10 - Error
    * 11 - Warning

### Ошибки форм

```javascript
{
    // ошибки формы в целом
    'global': [
        {}, {}, {} // list of AEO
    ],
    // ошбики к каждому полю конкретно
    'fields': [
        'fieldname': [
            {}, {}, {} // list of AEO
        ],
        // ...
        'last_field': [
            {}, {}, {} // list of AEO
        ]
    ]
}
```



## API

### **POST Login**

URL: `/user/login`

REQUEST

```javascript
{
    'email': 'example@example.com',
    'password': 'qwerty123'
}
```

RESPONSE 200

```javascript
// Detailed own info

{
    'nickname': 'Nagibator',
    'name': 'Lev Tolstoy'
    'email': 'lev.tolstoy@ya.ru'
    'avatar': '/avatar/url' // url аватара
    'bio': 'A Russian writer who is regarded as one of the greatest authors of all time'
}
```
RESPONCE 401

```
{
    
}
```

### **POST Register**

URL: `/user/register`

